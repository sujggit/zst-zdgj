function IpV4Box(b,a){this.id=b;this.onChange=new Function();this.onEnterKey=new Function();this.disabled=false;IpV4Box.all[b]=this;if(a){if(typeof a=="string"){a=document.getElementById(a);}a.innerHTML=this.toString();}}IpV4Box.all={};IpV4Box.EnabledClassName="ipInput oneInput";IpV4Box.DisabledClassName="ipInput oneInputDisabled";IpV4Box.prototype={focus:function(a){if(!a){a=1;}document.getElementById(this.id+"_"+a).focus();},setEnable:function(c){var a=!c;this.disabled=!c;var e=document.getElementById(this.id).getElementsByTagName("input");for(var d=0;d<e.length;d++){e.readOnly=a;}document.getElementById(this.id).className=c?IpV4Box.EnabledClassName:IpV4Box.DisabledClassName;},toString:function(){return'<span  id="'+this.id+'" class="'+IpV4Box.EnabledClassName+'"  >			<input onkeypress="IpV4Box.evt.keypress(this,event)" onkeydown="IpV4Box.evt.keydown(this,event)" onfocus="IpV4Box.evt.focus(this,event)" onpaste="IpV4Box.evt.change(this,event);" oninput="IpV4Box.evt.change(this,event);" onchange="IpV4Box.evt.change(this,event);"  type="text" size=3  id="'+this.id+'_1" maxlength=3			/>.<input onkeypress="IpV4Box.evt.keypress(this,event)" onkeydown="IpV4Box.evt.keydown(this,event)" onfocus="IpV4Box.evt.focus(this,event)" onpaste="IpV4Box.evt.change(this,event);" oninput="IpV4Box.evt.change(this,event);" onchange="IpV4Box.evt.change(this,event);"  type="text" size=3  id="'+this.id+'_2" maxlength=3			/>.<input onkeypress="IpV4Box.evt.keypress(this,event)" onkeydown="IpV4Box.evt.keydown(this,event)" onfocus="IpV4Box.evt.focus(this,event)" onpaste="IpV4Box.evt.change(this,event);" oninput="IpV4Box.evt.change(this,event);" onchange="IpV4Box.evt.change(this,event);"  type="text" size=3  id="'+this.id+'_3" maxlength=3			/>.<input onkeypress="IpV4Box.evt.keypress(this,event)" onkeydown="IpV4Box.evt.keydown(this,event)" onfocus="IpV4Box.evt.focus(this,event)" onpaste="IpV4Box.evt.change(this,event);" oninput="IpV4Box.evt.change(this,event);" onchange="IpV4Box.evt.change(this,event);"  type="text" size=3 name="ip4Name" id="'+this.id+'_4" maxlength=3/>		</span>';},getValue:function(){var a=[document.getElementById(this.id+"_1").value,document.getElementById(this.id+"_2").value,document.getElementById(this.id+"_3").value,document.getElementById(this.id+"_4").value];return a.join(".");},setValue:function(a){a=a.replace(/[^\d.]/g,"");if(a==""){a="...";}a=a.split(".");document.getElementById(this.id+"_1").value=a[0];document.getElementById(this.id+"_2").value=a[1];document.getElementById(this.id+"_3").value=a[2];document.getElementById(this.id+"_4").value=a[3];}};IpV4Box.evt={focus:function(b,a){b.select();},change:function(c,a){var b=parseInt(c.value);if(b>=0&&b<=255){if(b!=c.value){c.value=b;}}else{c.value="";}IpV4Box.all[c.id.replace(/_\d$/,"")].onChange();},keypress:function(f,a){var d=a.charCode||a.keyCode;var i=IpV4Box.evt.getSelection(f);var e=f.value;var h=String.fromCharCode(d);if(d>=48&&d<=57){e=""+e.substring(0,i.start)+h+e.substring(i.end,e.length);if(parseInt(e)<255){var g=f.id;/(.*)_(\d)$/.test(g);var b=RegExp.$2;IP_id=RegExp.$1;if(parseInt(e)>=100){if(parseInt(b)<4){g=g.replace(/(\d)$/,parseInt(b)+1);setTimeout("document.getElementById('"+g+"').focus();"+"document.getElementById('"+g+"').select();",200);}}setTimeout("IpV4Box.all['"+IP_id+"'].onChange()",0);return true;}else{if(a.preventDefault){a.preventDefault();}a.returnValue=false;return false;}}else{if(a.preventDefault){a.preventDefault();}a.returnValue=false;}},keydown:function(d,j){var i=j.charCode||j.keyCode;var g=IpV4Box.evt.getSelection(d);var h=d.value;var f=String.fromCharCode(i);var a=d.id;/^(.*)_(\d)$/.test(a);var e=RegExp.$2;var b=RegExp.$1;switch(i){case 13:IpV4Box.all[b].onEnterKey();break;case 110:case 190:if(e<4){a=a.replace(/(\d)$/,parseInt(e)+1);document.getElementById(a).focus();document.getElementById(a).select();}break;case 38:h=!isNaN(parseInt(h))?parseInt(h):"";if(h==""){h=0;}if(h<255){d.value=h+1;}else{d.value=0;}break;case 40:h=!isNaN(parseInt(h))?parseInt(h):"";if(h==""){h=255;}if(h>0){d.value=h-1;}break;case 8:if(g.start>0){return;}case 37:if(g.end==0&&e>1){a=a.replace(/(\d)$/,parseInt(e)-1);document.getElementById(a).focus();document.getElementById(a).select();}break;case 39:if(g.start==h.length&&e<4){a=a.replace(/(\d)$/,parseInt(e)+1);document.getElementById(a).focus();document.getElementById(a).select();}break;}},getSelection:function(e){var a=this;if(e.createTextRange){var b=document.selection.createRange().duplicate();b.moveStart("character",-e.value.length);var d=b.text.length;var b=document.selection.createRange().duplicate();b.moveEnd("character",e.value.length);var c=e.value.lastIndexOf(b.text);if(b.text==""){c=e.value.length;}return{start:c,end:d};}else{return{start:e.selectionStart,end:e.selectionEnd};}}};
